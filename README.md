# DInclude

<ins>dinclude</ins> - это небольшое консольное приложение, позволяющее проанализировать зависимости исходного кода, установленные посредством директив `#include`.

## Аргументы приложения
### Синопсис
```bash
dinclude SOURCE_FILES_DIR [OPTIONS...]
```

### Опции

Пути для любых аргументов могут быть как абсолютными, так и относительными к папке из которой запускается приложение.

* `SOURCE_FILES_DIR` - путь к директории содержащей файлы исходного кода для анализа. Опрос файлов происходит рекурсивно, т.е. все файлы, которые окажутся в под-директориях также принимают участие в анализе. В данной версии поддерживаются исходные файлы только с расширением `*.hpp` либо `*.cpp` (то же самое справедливо для [алгоритма опроса вхождений](https://github.com/AlexandrSMed/DependenciesAnalyser/edit/master/README.md#%D0%B0%D0%BB%D0%B3%D0%BE%D1%80%D0%B8%D1%82%D0%BC-%D0%BF%D0%BE%D0%B8%D1%81%D0%BA%D0%B0) - опрашиваются только `*.hpp` и `*.cpp` файлы).

* `-I<dir> --include-directory[=]<dir>` - добавляет директорию к перечню путей для поиска зависимостей.

## Алгоритм поиска
При анализе, приложение следует правилам описанным в стандарте [ISO/IEC 9899:201x, секция 6.10.2 Source file inclusion](https://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf#page=182), а именно:
* Для директивы вида
```с++
#include <h-char-sequence> new-line
```
поиск осуществляется относительно директорий, зависящих от реализации и аргументов комплиятора. Т.к. <ins>dinclude</ins> [последней версии](https://github.com/AlexandrSMed/DependenciesAnalyser/releases) не берет в расчет какую-либо информацию о компиляторах, параметрах с которыми они используются и платформе, для которой из файлов исходного кода требуется собрать приложение, <ins>dinclude</ins> не может сделать обоснованное предположение о том где данные пути расположены и их необходимо указать в виде [аргументов приложения](https://github.com/AlexandrSMed/DependenciesAnalyser/edit/master/README.md#%D0%B0%D1%80%D0%B3%D1%83%D0%BC%D0%B5%D0%BD%D1%82%D1%8B-%D0%BF%D1%80%D0%B8%D0%BB%D0%BE%D0%B6%D0%B5%D0%BD%D0%B8%D1%8F).

* Для директивы вида
```с++
# include "q-char-sequence" new-line
```
поиск осуществляется относительно директории, в которой расположен файл содержащий исходный код. В случае неудачи, поиск указанного файла продолжится так, как если бы он был `h-char-sequence` заключенной в в угловые скобки.

* Для директив вида
```с++
# include pp-tokens new-line
```
поиск зависимостей в данной версии не реализован.

## Вывод данных
<ins>dinclude</ins> выводит в консоль дерево обнаруженных зависимостей, отражая "глубину" (относительно исходного файла) отступами. Для каждого файла <ins>dinclude</ins> подсчитывает количество "вхождений" (сколько раз данный файл включается в состав других файлов), в том числе косвенных (когда файл включен в состав других включенных файлов). Если в процессе опроса файлов, какой-либо оказался не найден, <ins>dinclude</ins> помечает его `(!)`. Если в процессе поиска была обнаружена циклическая зависимость, поиск по данной ветке прекращается, однако первое вхождение, по которой цикл был выявлен, по-прежнему учавствует в подсчете вхождений, выводится в консоль и помечается `(~)`.

### Пример

```bash
dinclude ~/MyProject/src -I ~/MyProject/include

"main.cpp"
__"A.hpp"
____"B.hpp"
__"B.hpp"
"A.cpp"
__"A.hpp"
____"B.hpp"
"B.cpp"
__"B.hpp"
"C.cpp"
__"C.hpp"
__"D.hpp"(!)
__"E.hpp"
____"C.cpp"(~)

"B.hpp" 4
"A.hpp" 2
"C.hpp" 1
"C.cpp" 1
"D.hpp" 1
"E.hpp" 1
"A.cpp" 0
"B.cpp" 0
"main.cpp" 0
```

Для данного примера файл соответствующий вхождению `D.hpp` не был найден, а вхождение `C.cpp` в `E.hpp` помечено как циклическое.
